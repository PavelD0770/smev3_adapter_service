# smev3_adapter_service
Web-сервис на python3 для работы с адаптером СМЭВ3 по HTTP
## Назначение
Данный проект представляет собой web-service на Python3 для работы с адаптером СМЭВ3. Сервис предоставляет HTTP REST API для отправки запросов СМЭВ3, фонового опроса адаптера СМЭВ3 с целью получения ответов и возврата ответов СМЭВ3 по HTTP REST API.
## Архитектура системы
smev3_adapter_service использует Mongo и Sanic
![Архитектура](https://raw.githubusercontent.com/s-sokolko/smev3_adapter_service/master/architecture.jpg)
## Примеры запросов и поддерживаемые маршруты
Тело запроса и ответа представляет собой JSON, полностью аналогичный по структуре XML того запроса, который передаётся. Для авторизации всегда нужен заголовок HTTP X-Auth-Token.
Для отправки запроса в СМЭВ используется URL /schedule_query/<тип_запроса>/

Примеры отправки запроса для получения выписок ЕГРЮЛ и ЕГРИП

`POST http://localhost:9003/schedule_query/FNSVipUL/
{
"ЗапросЮЛ": {
"ОГРН": "1027700070518"
},
"ИдДок": "3"
}`

`http://localhost:9003/schedule_query/FNSVipIP/
{
"ЗапросИП": {
"ОГРНИП": "315723200006533"
},
"ИдДок": "4"
}`

Для получения ответов используется URL /get_document/<тип_запроса>/<идентификатор_запроса>

Примеры получения ответа для получения выписок ЕГРЮЛ и ЕГРИП:


`http://localhost:9003/get_document/FNSVipUL/1027700070518`

`http://localhost:9003/get_document/FNSVipIP/315723200006533`

Допустимые типы запросов и идентификаторы для каждого типа запросов определяются настройками

## Настройки приложения
MONGO_URL - адрес для доступа к mongo
ADAPTER_SETTINGS - словарь с 

## Запуск приложения
Для запуска нужно отредактировать файл settings.py в корне проекта, а затем выполнить
`make run`
